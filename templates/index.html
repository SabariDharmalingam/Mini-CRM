<!DOCTYPE html>
<html>
<head>
    <title>CRM Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #f4f6fb;
        }
        .navbar {
            background: #0d6efd;
        }
        .card-summary {
            border-left: 5px solid #0d6efd;
            transition: 0.3s;
        }
        .card-summary:hover {
            transform: scale(1.03);
        }
        .badge-status {
            padding: 5px 10px;
            border-radius: 8px;
            font-size: 12px;
            color: white;
        }
        .New { background: #0d6efd; }
        .Contacted { background: #ffc107; color: black !important; }
        .Qualified { background: #17a2b8; }
        .Converted { background: #28a745; }
        .lead-table {
            background: #fff;
            border-radius: 12px;
            padding: 20px;
        }
    </style>
</head>

<body>

<nav class="navbar navbar-dark px-4">
    <span class="navbar-brand mb-0 h1">ðŸš€ CRM Dashboard</span>

    <a href="/export" class="btn btn-light">â¬‡ Export Excel</a>
    <a href="/logout" class="btn btn-danger ms-2">Logout</a>
</nav>

<div class="container mt-4">

    <!-- Search Bar -->
    <form method="GET" action="/" class="input-group mb-4">
        <input type="text" class="form-control" name="search" placeholder="Search name, email, phone..." value="{{ search }}">
        <button class="btn btn-primary">Search</button>
    </form>

    <!-- Add Lead Form -->
    <div class="card p-4 shadow mb-4">
        <h4>Add New Lead</h4>
        <form action="/add" method="POST" class="row g-3 mt-2">
            <div class="col-md-4">
                <input class="form-control" name="name" placeholder="Full Name" required>
            </div>
            <div class="col-md-4">
                <input class="form-control" name="email" placeholder="Email">
            </div>
            <div class="col-md-4">
                <input class="form-control" name="phone" placeholder="Phone">
            </div>

            <div class="col-md-4">
                <select class="form-control" name="status">
                    <option>New</option>
                    <option>Contacted</option>
                    <option>Qualified</option>
                    <option>Converted</option>
                </select>
            </div>

            <div class="col-md-4">
                <select class="form-control" name="source">
                    <option>Website</option>
                    <option>Facebook</option>
                    <option>Instagram</option>
                    <option>Referral</option>
                    <option>Phone Call</option>
                </select>
            </div>

            <div class="col-md-12">
                <textarea class="form-control" name="notes" placeholder="Notes"></textarea>
            </div>

            <div class="col-md-2">
                <button class="btn btn-primary w-100">Add Lead</button>
            </div>
        </form>
    </div>

    <!-- Lead List -->
    <div class="lead-table shadow">
        <h4>Lead List</h4>
        <table class="table table-hover mt-3">
            <thead>
                <tr>
                    <th>Name</th><th>Email</th><th>Phone</th>
                    <th>Status</th><th>Source</th><th>Created</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for lead in leads %}
                <tr>
                    <td>{{ lead[1] }}</td>
                    <td>{{ lead[2] }}</td>
                    <td>{{ lead[3] }}</td>

                    <td>
                        <span class="badge-status {{ lead[4] }}">{{ lead[4] }}</span>
                    </td>

                    <td>{{ lead[5] }}</td>
                    <td>{{ lead[7][:10] }}</td>

                    <td>
                        <a href="/edit/{{ lead[0] }}" class="btn btn-sm btn-warning">Edit</a>
                        <a href="/delete/{{ lead[0] }}" class="btn btn-sm btn-danger"
                           onclick="return confirm('Delete this lead?')">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

</div>

</body>
</html>
